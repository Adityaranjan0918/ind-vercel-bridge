<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indra AI | Ultimate IND Coders</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #020617;
            --card: rgba(15, 23, 42, 0.7);
            --border: rgba(51, 65, 85, 0.4);
            --accent: #3b82f6;
            --text: #f8fafc;
        }

        [data-theme="light"] {
            --bg: #f8fafc;
            --card: rgba(255, 255, 255, 0.8);
            --border: rgba(203, 213, 225, 0.6);
            --accent: #2563eb;
            --text: #0f172a;
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            transition: all 0.5s ease;
            overflow: hidden;
        }

        .glass {
            backdrop-filter: blur(16px);
            background: var(--card);
            border: 1px solid var(--border);
        }

        /* Creative Model Hub Styles */
        .model-hub {
            display: flex;
            gap: 8px;
            background: rgba(0,0,0,0.3);
            padding: 5px;
            border-radius: 20px;
            border: 1px solid var(--border);
        }

        .model-card {
            cursor: pointer;
            padding: 8px 16px;
            border-radius: 15px;
            font-size: 11px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: flex;
            align-items: center;
            gap: 6px;
            color: #64748b;
        }

        .model-card.active[data-model="flash"] { background: #eab308; color: black; box-shadow: 0 0 20px rgba(234, 179, 8, 0.4); }
        .model-card.active[data-model="pro"] { background: #3b82f6; color: white; box-shadow: 0 0 20px rgba(59, 130, 246, 0.4); }
        .model-card.active[data-model="think"] { background: #a855f7; color: white; box-shadow: 0 0 20px rgba(168, 85, 247, 0.4); }

        /* Sidebar Transition */
        #sidebar {
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateX(-100%);
        }
        #sidebar.open { transform: translateX(0); }

        /* Custom Scrollbar */
        .chat-flow::-webkit-scrollbar { width: 4px; }
        .chat-flow::-webkit-scrollbar-thumb { background: var(--border); border-radius: 10px; }

        @keyframes pulse-glow {
            0% { box-shadow: 0 0 5px var(--accent); }
            50% { box-shadow: 0 0 20px var(--accent); }
            100% { box-shadow: 0 0 5px var(--accent); }
        }
        
        .ai-glow { animation: pulse-glow 3s infinite; }
    </style>
</head>
<body class="h-screen flex flex-col">

    <!-- Splash Screen -->
    <div id="splash" class="fixed inset-0 z-[100] bg-[#020617] flex flex-col items-center justify-center">
        <svg viewBox="0 0 100 100" class="w-24 h-24 mb-8">
            <path d="M50 20 L80 75 L20 75 Z" stroke="#3b82f6" stroke-width="3" fill="none" />
            <circle cx="50" cy="50" r="6" fill="#3b82f6" />
        </svg>
        <div class="text-center px-6">
            <h1 class="text-4xl md:text-5xl font-black tracking-tight text-white mb-2 min-h-[48px] md:min-h-[60px]">
                <span id="type-1"></span><span id="cursor-1" class="text-blue-500 animate-pulse">|</span>
            </h1>
            <h2 class="text-2xl md:text-3xl font-bold text-blue-500 tracking-wide uppercase min-h-[32px] md:min-h-[40px]">
                <span id="type-2"></span><span id="cursor-2" class="text-white animate-pulse hidden">|</span>
            </h2>
        </div>
        <p class="mt-12 text-[10px] text-slate-500 font-bold uppercase tracking-[0.2em]">IND CODERS | ADITYA RANJAN</p>
    </div>

    <!-- Sidebar Menu -->
    <aside id="sidebar" class="fixed inset-y-0 left-0 w-80 z-50 glass shadow-2xl flex flex-col">
        <div class="p-6 border-b border-slate-700/50 flex justify-between items-center">
            <span class="font-black text-xl tracking-tighter">INDRA SYSTEM</span>
            <button onclick="toggleMenu()" class="text-2xl">&times;</button>
        </div>
        <div class="p-4 space-y-2 overflow-y-auto flex-1">
            <button onclick="startNewChat()" class="w-full flex items-center gap-4 p-4 rounded-2xl bg-blue-600/10 hover:bg-blue-600/20 transition-all font-bold text-sm text-blue-400">
                <span class="text-xl">‚ûï</span> New Chat
            </button>
            <button onclick="showHistory()" class="w-full flex items-center gap-4 p-4 rounded-2xl hover:bg-blue-600/10 transition-all font-bold text-sm">
                <span class="text-xl">üìú</span> Chat History
            </button>
            <button onclick="openIndLab()" class="w-full flex items-center gap-4 p-4 rounded-2xl hover:bg-purple-600/10 transition-all font-bold text-sm text-purple-400">
                <span class="text-xl">üß™</span> IND Coder Lab
            </button>
            <button onclick="showDiagnostics()" class="w-full flex items-center gap-4 p-4 rounded-2xl hover:bg-cyan-600/10 transition-all font-bold text-sm">
                <span class="text-xl">‚öôÔ∏è</span> System Diagnostics
            </button>
            <button onclick="clearChat()" class="w-full flex items-center gap-4 p-4 rounded-2xl hover:bg-red-600/10 transition-all font-bold text-sm text-red-400">
                <span class="text-xl">üóëÔ∏è</span> Clear Memory
            </button>
            <div class="pt-6 px-4">
                <p class="text-[10px] font-black text-slate-500 uppercase tracking-widest mb-4">Developed By</p>
                <div class="p-4 glass rounded-2xl bg-blue-600/5">
                    <p class="text-blue-500 font-black">Aditya Ranjan</p>
                    <p class="text-[10px] text-slate-400">Chief Developer, IND Coders</p>
                </div>
            </div>
        </div>
    </aside>

    <!-- Header -->
    <header class="h-20 flex items-center justify-between px-6 glass sticky top-0 z-40">
        <div class="flex items-center gap-4">
            <button onclick="toggleMenu()" class="p-2.5 rounded-xl border border-slate-700/50 hover:bg-slate-500/10 transition-all">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
            </button>
            <div class="flex items-center gap-2">
                <svg viewBox="0 0 100 100" class="w-8 h-8"><path d="M50 25 L75 70 L25 70 Z" stroke="#3b82f6" stroke-width="8" fill="none"/></svg>
                <h2 class="font-black tracking-tighter text-xl hidden sm:block">INDRA</h2>
            </div>
        </div>

        <!-- Creative Model Selector -->
        <div class="model-hub scale-90 sm:scale-100">
            <div class="model-card active" data-model="pro" onclick="selectModel('pro')">
                <span>üíé</span> Pro
            </div>
            <div class="model-card" data-model="flash" onclick="selectModel('flash')">
                <span>‚ö°</span> Flash
            </div>
            <div class="model-card" data-model="think" onclick="selectModel('think')">
                <span>üß†</span> Logic
            </div>
        </div>

        <button id="theme-btn" onclick="toggleTheme()" class="w-10 h-10 rounded-full glass flex items-center justify-center hover:rotate-12 transition-all">
            <span id="theme-ico">üîÜ</span>
        </button>
    </header>

    <!-- Main View -->
    <main id="chat-viewport" class="flex-1 overflow-y-auto p-4 md:p-8 chat-flow">
        <div id="messages-area" class="max-w-4xl mx-auto">
            <!-- Empty State -->
            <div id="welcome-view" class="mt-24 text-center">
                <div class="w-24 h-24 mx-auto mb-8 relative">
                    <svg viewBox="0 0 100 100" class="w-full h-full"><path d="M50 20 L80 75 L20 75 Z" stroke="#3b82f6" stroke-width="2" fill="none"/></svg>
                    <div class="absolute inset-0 bg-blue-500/20 blur-3xl animate-pulse"></div>
                </div>
                <h1 class="text-4xl font-black tracking-tighter mb-4">Neural System Ready.</h1>
                <p class="text-slate-500 max-w-sm mx-auto font-bold text-sm">Welcome to the Indra Neural Interface. Developed by Aditya Ranjan for optimized cognitive support.</p>
            </div>
        </div>
    </main>

    <!-- Typing Indicator -->
    <div id="typing" class="hidden max-w-4xl mx-auto px-6 mb-6">
        <div class="flex items-center gap-2 text-blue-500 font-black text-[10px] uppercase tracking-widest animate-pulse">
            Neural link active...
        </div>
    </div>

    <!-- Input Footer -->
    <footer class="p-6">
        <div class="max-w-4xl mx-auto">
            <form id="main-form" class="glass rounded-[2rem] p-2 flex items-center focus-within:ring-2 ring-blue-500/40 transition-all shadow-2xl">
                <input type="text" id="user-input" autocomplete="off" placeholder="Ask Indra anything..." class="flex-1 bg-transparent px-6 py-4 outline-none font-semibold placeholder-slate-500">
                <button type="submit" class="w-14 h-14 bg-blue-600 hover:bg-blue-500 text-white rounded-[1.5rem] flex items-center justify-center shadow-lg transition-all active:scale-90">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
                </button>
            </form>
            <div class="mt-4 px-6 flex justify-between items-center opacity-40">
                <span class="text-[9px] font-black uppercase tracking-widest">INDRA CORE v4.0.1</span>
                <span class="text-[9px] font-black uppercase tracking-widest">Dev: Aditya Ranjan</span>
            </div>
        </div>
    </footer>

    <!-- Overlay Modals -->
    <div id="modal-overlay" class="fixed inset-0 z-[60] bg-black/60 backdrop-blur-sm hidden flex items-center justify-center p-6" onclick="closeModal()">
        <div class="glass max-w-md w-full p-8 rounded-[2rem] animate-in zoom-in duration-300" onclick="event.stopPropagation()">
            <h2 id="modal-title" class="text-2xl font-black mb-4">Title</h2>
            <div id="modal-body" class="text-sm font-medium text-slate-400 leading-relaxed mb-6">Body text here.</div>
            <button onclick="closeModal()" class="w-full py-4 bg-slate-800 rounded-2xl font-bold uppercase tracking-widest text-xs">Dismiss</button>
        </div>
    </div>

    <script>
        // Notice the API key has been removed from the frontend code completely.
        const SYSTEM_PROMPT = "You are Indra AI, developed by IND Coders Developer Aditya Ranjan. You are a genius AI. Never mention other companies.";
        
        let state = {
            model: 'pro',
            history: [],
            isDark: true
        };

        // Initialize
        window.onload = () => {
            // Typewriter Effect Logic
            const str1 = "Namaste";
            const str2 = "Indra AI Welcome's You";
            const t1 = document.getElementById('type-1');
            const t2 = document.getElementById('type-2');
            const c1 = document.getElementById('cursor-1');
            const c2 = document.getElementById('cursor-2');
            
            let i = 0, j = 0;
            
            function type1() {
                if (i < str1.length) {
                    t1.innerHTML += str1.charAt(i);
                    i++;
                    setTimeout(type1, 80);
                } else {
                    c1.classList.add('hidden');
                    c2.classList.remove('hidden');
                    setTimeout(type2, 200);
                }
            }
            
            function type2() {
                if (j < str2.length) {
                    t2.innerHTML += str2.charAt(j);
                    j++;
                    setTimeout(type2, 50);
                }
            }
            
            setTimeout(type1, 400);

            // Splash Screen Hide Logic
            setTimeout(() => { document.getElementById('splash').style.display = 'none'; }, 3500);
            loadHistory();
        };

        // Navigation
        function toggleMenu() {
            document.getElementById('sidebar').classList.toggle('open');
        }

        function toggleTheme() {
            state.isDark = !state.isDark;
            document.documentElement.setAttribute('data-theme', state.isDark ? 'dark' : 'light');
            document.getElementById('theme-ico').innerText = state.isDark ? 'üîÜ' : 'üåô';
        }

        function selectModel(m) {
            state.model = m;
            document.querySelectorAll('.model-card').forEach(c => {
                c.classList.remove('active');
                if(c.dataset.model === m) c.classList.add('active');
            });
        }

        // Menu Actions 
        function startNewChat() {
            document.getElementById('messages-area').innerHTML = `
                <div id="welcome-view" class="mt-24 text-center">
                    <div class="w-24 h-24 mx-auto mb-8 relative">
                        <svg viewBox="0 0 100 100" class="w-full h-full"><path d="M50 20 L80 75 L20 75 Z" stroke="#3b82f6" stroke-width="2" fill="none"/></svg>
                        <div class="absolute inset-0 bg-blue-500/20 blur-3xl animate-pulse"></div>
                    </div>
                    <h1 class="text-4xl font-black tracking-tighter mb-4">New Session Started.</h1>
                    <p class="text-slate-500 max-w-sm mx-auto font-bold text-sm">Neural buffers cleared. How can Aditya Ranjan's system assist you now?</p>
                </div>
            `;
            toggleMenu();
        }

        function openIndLab() {
            openModal("IND Coder Lab", "Welcome to the Research Division of IND Coders.<br><br>Status: Experimental<br>Projects: Neural Logic v5, Vision Core 2.0<br>Developer: Aditya Ranjan<br><br>This module is currently processing advanced datasets.");
        }

        function showHistory() {
            const historyText = state.history.length > 0 
                ? state.history.slice(-5).map(h => `‚Ä¢ ${h.substring(0, 40)}...`).join('<br>')
                : "No recent memory found.";
            openModal("Chat History", historyText);
        }

        function showDiagnostics() {
            const diag = `
                Status: Operational<br>
                Core: Indra v4.0.1<br>
                Developer: Aditya Ranjan<br>
                Environment: IND Coders Production Tier
            `;
            openModal("System Diagnostics", diag);
        }

        function clearChat() {
            document.getElementById('messages-area').innerHTML = `
                <div id="welcome-view" class="mt-24 text-center">
                    <h1 class="text-4xl font-black tracking-tighter mb-4">Memory Wiped.</h1>
                </div>
            `;
            state.history = [];
            localStorage.removeItem('indra_history');
            toggleMenu();
        }

        // Modal Control
        function openModal(title, body) {
            document.getElementById('modal-title').innerText = title;
            document.getElementById('modal-body').innerHTML = body;
            document.getElementById('modal-overlay').classList.remove('hidden');
        }
        function closeModal() { document.getElementById('modal-overlay').classList.add('hidden'); }

        // Chat Engine
        const form = document.getElementById('main-form');
        const input = document.getElementById('user-input');
        const area = document.getElementById('messages-area');
        const view = document.getElementById('chat-viewport');
        const typing = document.getElementById('typing');

        form.onsubmit = async (e) => {
            e.preventDefault();
            const msg = input.value.trim();
            if(!msg) return;

            document.getElementById('welcome-view')?.remove();
            addBubble(msg, 'user');
            input.value = '';
            
            typing.classList.remove('hidden');
            view.scrollTop = view.scrollHeight;

            try {
                // IMPORTANT: Pointing to Vercel Serverless Function instead of Google API directly!
                const res = await fetch(`/api/chat`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        contents: [{parts: [{text: msg}]}],
                        systemInstruction: {parts: [{text: `${SYSTEM_PROMPT} You are currently in ${state.model} mode.`}]}
                    })
                });
                
                const data = await res.json();
                
                if(data.error) {
                    addBubble(`System Error: ${data.error}`, 'ai');
                } else {
                    const text = data.candidates?.[0]?.content?.parts?.[0]?.text || "Signal interrupted.";
                    addBubble(text, 'ai');
                    state.history.push(msg);
                    saveHistory();
                }
            } catch (err) {
                addBubble("Aditya Ranjan's server is currently unreachable. Check your connection or API configuration.", 'ai');
            } finally {
                typing.classList.add('hidden');
                view.scrollTop = view.scrollHeight;
            }
        };

        function addBubble(text, role) {
            const div = document.createElement('div');
            div.className = `flex ${role === 'user' ? 'justify-end' : 'justify-start'} mb-8 animate-in slide-in-from-bottom-5 duration-500`;
            div.innerHTML = `
                <div class="flex gap-4 max-w-[85%] ${role === 'user' ? 'flex-row-reverse' : ''}">
                    <div class="w-10 h-10 rounded-2xl flex items-center justify-center border border-white/10 ${role === 'user' ? 'bg-blue-600' : 'glass ai-glow'}">
                        ${role === 'ai' ? `<svg viewBox="0 0 100 100" class="w-6 h-6"><path d="M50 25 L75 70 L25 70 Z" stroke="white" stroke-width="10" fill="none"/></svg>` : `<span class="font-bold text-white">U</span>`}
                    </div>
                    <div class="p-5 rounded-[1.8rem] ${role === 'user' ? 'bg-blue-600 text-white rounded-tr-none' : 'glass text-slate-200 rounded-tl-none'} shadow-2xl">
                        <p class="text-sm font-medium whitespace-pre-wrap leading-relaxed">${text}</p>
                    </div>
                </div>
            `;
            area.appendChild(div);
            view.scrollTop = view.scrollHeight;
        }

        function saveHistory() { localStorage.setItem('indra_history', JSON.stringify(state.history)); }
        function loadHistory() {
            const saved = localStorage.getItem('indra_history');
            if(saved) state.history = JSON.parse(saved);
        }
    </script>
</body>
</html>
